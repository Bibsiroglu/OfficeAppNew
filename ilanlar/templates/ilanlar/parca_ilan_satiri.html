{% load static %}
{% comment %}
Bu parÃ§acÄ±k, ilan listesindeki tek bir satÄ±rÄ± Ã§izer.
Gerekli deÄŸiÅŸkenler: ilan, uyari_sinifi
{% endcomment %}

{# ---------------------------------------------------------------------------------- #}
{# NOT: uyari_sinifi, views'dan BUGÃœN KALKAN ilanlar iÃ§in "list-group-item-danger fw-bold" olarak gelir #}
{# ---------------------------------------------------------------------------------- #}

<a href="{% url 'ilan_detay' ilan.pk %}"
    class="list-group-item list-group-item-action d-flex flex-wrap align-items-center py-3 {{ uyari_sinifi }}">

    <div class="col-12 col-md-2 mb-2 mb-md-0">
        <p class="mb-0 small text-primary fw-bold">{{ ilan.ilan_no }}</p>
        <span class="badge bg-secondary">{{ ilan.ana_kategori|capfirst }}</span>
        {% if ilan.durum != 'Aktif' %}
        <span class="badge bg-danger ms-2">{{ ilan.get_durum_display|upper }}</span>
        {% endif %}
        {% if ilan.durum == 'Aktif' %}
        <span class="badge bg-warning text-dark text-uppercase">{{ ilan.get_durum_display|upper }}</span>
        {% endif %}
    </div>

    <div class="col-12 col-md-4 mb-2 mb-md-0">
        <h6 class="mb-1 text-truncate">{{ ilan.baslik }}</h6>

        {% comment %} Konum Bilgisi {% endcomment %}
        {% if ilan.il and ilan.mahalle %}
        <small class="text-muted d-block">
            <i class="fas fa-map-marker-alt"></i> {{ ilan.il }} / {{ ilan.mahalle }}
        </small>
        {% endif %}

        {% comment %} Randevu SayÄ±sÄ± Bilgisi (views.py'den gelen toplam_randevu_sayisi'nÄ± kullanÄ±r) {% endcomment %}
        {% if ilan.toplam_randevu_sayisi %}
        <small class='text-muted randevu-ozet-bilgi d-block mt-1'>
            ğŸ“… Randevu GeÃ§miÅŸi ({{ toplam_randevu_sayisi }} Adet)
        </small>
        {% endif %}
    </div>

    <div class="col-6 col-md-2 text-center border-start mb-2 mb-md-0">
        <p class="mb-0 small"><i class="fas fa-bed text-info"></i> **{{ ilan.oda_sayisi }}**</p>
        <p class="mb-0 small text-muted"><i class="fas fa-ruler-combined"></i> {{ ilan.net|floatformat:0 }} mÂ²</p>
    </div>

    <div class="col-6 col-md-2 text-center border-start mb-2 mb-md-0">
        <p class="h6 text-success fw-bold mb-0">
            {{ ilan.fiyat|floatformat:3 }} â‚º
        </p>

        {% comment %} Ä°ÅŸlem Tipini ve Renklendirmeyi GÃ¶ster {% endcomment %}
        {% if ilan.islem_tipi == 'satilik' %}
        <span class="badge bg-danger text-uppercase">{{ ilan.get_islem_tipi_display }}</span>
        {% elif ilan.islem_tipi == 'kiralik' %}
        <span class="badge bg-warning text-dark text-uppercase">{{ ilan.get_islem_tipi_display }}</span>
        {% else %}
        <span class="badge bg-secondary text-uppercase">{{ ilan.get_islem_tipi_display|default:"-" }}</span>
        {% endif %}

        <small class="badge bg-secondary">{{ ilan.detay_kategori|capfirst }}</small>
    </div>

    <div class="col-12 col-md-2 text-center border-start">
        {% if uyari_sinifi %}
        {# EÄŸer uyarÄ± sÄ±nÄ±fÄ± varsa, kÄ±rmÄ±zÄ± uyarÄ± mesajÄ±nÄ± gÃ¶ster #}
        <span class="text-danger fw-bold">ğŸš¨ BUGÃœN KALKIYOR!</span>
        {% else %}
        {# Normal kayÄ±tlarda ilan tarihini gÃ¶ster #}
        {{ ilan.yayindan_kaldirilma_tarihi|date:"d.m.Y" }}
        {% endif %}
    </div>
    {# DÃœZENLEME BUTONU #}
    <a href="/admin/ilanlar/ilan/{{ ilan.pk }}/change/" class="btn btn-sm btn-primary mt-2"
        title="Ä°lanÄ± YÃ¶netim Panelinde DÃ¼zenle">
        <i class="fas fa-edit"></i> DÃ¼zenle
    </a>

</a>